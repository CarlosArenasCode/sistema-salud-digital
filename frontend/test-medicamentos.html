<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Medicamentos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Test - Módulo de Medicamentos</h2>
        <div id="status" class="alert alert-info">Cargando...</div>
        <div id="data"></div>
    </div>

    <script src="js/utils.js"></script>
    <script>
        async function testMedicamentos() {
            const statusDiv = document.getElementById('status');
            const dataDiv = document.getElementById('data');
            
            try {
                statusDiv.textContent = 'Probando conexión...';
                console.log('Probando AppUtils.get...');
                
                const medicamentos = await AppUtils.get('/api/medicamentos');
                console.log('Medicamentos obtenidos:', medicamentos);
                
                statusDiv.className = 'alert alert-success';
                statusDiv.textContent = `✅ Éxito: ${medicamentos.length} medicamentos cargados`;
                
                // Mostrar datos
                dataDiv.innerHTML = `
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Código</th>
                                <th>Nombre</th>
                                <th>Categoría</th>
                                <th>Precio</th>
                                <th>Stock</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${medicamentos.map(m => `
                                <tr>
                                    <td>${m.id}</td>
                                    <td>${m.codigo || 'N/A'}</td>
                                    <td>${m.nombre}</td>
                                    <td>${m.categoria || 'N/A'}</td>
                                    <td>$${parseFloat(m.precio || 0).toFixed(2)}</td>
                                    <td>${m.stock || 0}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
            } catch (error) {
                console.error('Error:', error);
                statusDiv.className = 'alert alert-danger';
                statusDiv.textContent = `❌ Error: ${error.message}`;
                
                dataDiv.innerHTML = `<pre>${JSON.stringify(error, null, 2)}</pre>`;
            }
        }
        
        // Ejecutar la prueba cuando la página cargue
        document.addEventListener('DOMContentLoaded', testMedicamentos);
    </script>
</body>
</html>
